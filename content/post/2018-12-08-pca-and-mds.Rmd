---
title: PCA and MDS
author: Jung-Jin Lee
date: '2018-12-08'
slug: pca-and-mds
categories: []
tags: []
---

```{r, echo = F}
knitr::opts_chunk$set(
  message = F
)
```

```{r, echo = F}
n <- 100
```

A mock data set consisting of `r n` data points, say $\mathbf{P}_1, \cdots, \mathbf{P}_{`r n`}$ in $\mathbb{R}^3$\:

```{r}
set.seed(2018)
n <- 100
Xraw <- data.frame(x = rnorm(n, mean = 3, sd = 1),
                   y = rnorm(n, mean = 2, sd = 2),
                   z = rnorm(n, mean = -1, sd = 1)) 
dim(Xraw)
```

```{r}
library(plotly)
colored <- c("P1", "P2", "P3", rep("P4 - P100", n-3))
plot_ly(Xraw, x = ~x, y = ~y, z = ~z, 
        color = colored,
        colors = c("red", "blue", "green", "grey")) %>%
  add_markers() 
```

Our goal is to find a _good_ (meaning to be clarified later) two dimensional projection $\mathbf{Q}_1, \cdots, \mathbf{Q}_{`r n`}$ of $\mathbf{P}_1, \cdots, \mathbf{P}_{`r n`}$ so that we can reduce the dimension (from 3 to 2) of data and visualize them. 

If $x$, $y$, and $z$ variables need to be equally weighted, then the data points should be centered and normalized:

```{r}
Xs <- scale(Xraw) %>%
  as.data.frame()
plot_ly(Xs, x = ~x, y = ~y, z = ~z, 
        color = colored, 
        colors = c("red", "blue", "green", "grey")) %>%
  add_markers() 
```

```{r}
scene = list(camera = list(up = list(x = 1, y = 0, z = 0),
                           eye = list(x = 0, y = 0, z = 1.8)))
Y <- prcomp(Xraw, center = T, scale = T)$x %>%
  as.data.frame()
plot_ly(Y, x = ~PC1, y = ~PC2, z = ~PC3, 
        color = colored,
        colors = c("red", "blue", "green", "grey")) %>%
  add_markers() %>%
  layout(scene = scene)
  
```

Compare:

```{r}
Y %>% mutate(color_code = colored) %>%
  ggplot(aes(PC1, PC2, color = color_code)) +
  scale_color_manual(values = c("red", "blue", "green", "grey")) +
  theme(aspect.ratio = 1) +
  geom_point()
```


