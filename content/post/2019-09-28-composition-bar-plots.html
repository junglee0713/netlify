---
title: '그림을 그립시다 The Joy of ggplotting: compositional bar plots'
author: Jung-Jin Lee
date: '2019-09-28'
slug: compositional-bar-plots
---



<div class="figure" style="text-align: center">
<img src="/bob-ross.jpg" alt="We don't make mistakes, just happy little accidents." width="70%" />
<p class="caption">
We don’t make mistakes, just happy little accidents.
</p>
</div>
<p>First of all, download a publicly available dataset from kaggle <a href="https://www.kaggle.com/bbhatt001/human-microbiome-project" class="uri">https://www.kaggle.com/bbhatt001/human-microbiome-project</a></p>
<pre class="r"><code>library(tidyverse)  
d0 &lt;- read_csv(&quot;project_catalog.csv&quot;)
dim(d0)</code></pre>
<pre><code>## [1] 2915   17</code></pre>
<pre class="r"><code>names(d0)</code></pre>
<pre><code>##  [1] &quot;HMP ID&quot;                  &quot;GOLD ID&quot;                
##  [3] &quot;Organism Name&quot;           &quot;Domain&quot;                 
##  [5] &quot;NCBI Superkingdom&quot;       &quot;HMP Isolation Body Site&quot;
##  [7] &quot;Project Status&quot;          &quot;Current Finishing Level&quot;
##  [9] &quot;NCBI Submission Status&quot;  &quot;NCBI Project ID&quot;        
## [11] &quot;Genbank ID&quot;              &quot;Gene Count&quot;             
## [13] &quot;IMG/HMP ID&quot;              &quot;HOMD ID&quot;                
## [15] &quot;Sequencing Center&quot;       &quot;Funding Source&quot;         
## [17] &quot;Strain Repository ID&quot;</code></pre>
<pre class="r"><code>table(d0$`HMP Isolation Body Site`) </code></pre>
<pre><code>## 
##                airways                  blood                   bone 
##                    236                     75                     27 
##                    ear                    eye gastrointestinal_tract 
##                      4                      8                    745 
##                  heart                  liver            lymph_nodes 
##                      2                      1                      1 
##                   nose                   oral                  other 
##                      2                    347                     13 
##                   skin                unknown       urogenital_tract 
##                    267                    654                    529 
##                  wound 
##                      4</code></pre>
<p>We subset the data to inlcude body sites with sufficient data:</p>
<pre class="r"><code>d &lt;- d0 %&gt;%
  filter(`HMP Isolation Body Site` %in% c(&quot;airways&quot;, &quot;gastrointestinal_tract&quot;,
                                          &quot;oral&quot;, &quot;skin&quot;, &quot;urogenital_tract&quot;)) %&gt;%
  mutate(`Body site` = factor(`HMP Isolation Body Site`)) %&gt;%
  mutate(Genus = str_extract(`Organism Name`, &quot;^[^\\s]+&quot;)) # extract the string before the first space</code></pre>
<p>To be continued…</p>
