---
title: "Lecture 2"
author: "Jung-Jin Lee"
date: "Jan 23, 2019"
output:
  xaringan::moon_reader:
    css: ["default", "default-fonts", "Cabrini.css"] 
    lib_dir: libs
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      
---
```{r, message = F, echo = F, warning = F}
library(tidyverse) 
library(gridExtra)
library(knitr) 
opts_chunk$set(
  tidy = FALSE,
  cache = FALSE,
  echo = TRUE,
  warning = FALSE,
  message = FALSE,
  dpi = 300,
  fig.align = "center",
  fig.width = 4,
  fig.height = 4
  )
```

## Type of data

- Categorical Data - consist of qualitative values
  - Nominal values: gender, coat colors
  - Ordinal values: body conditions, age groups
  
- Numerical Data - consist of quantitative values
  - Discrete values: litter size, parity
  - Continuous values: height, weight, temperature
  
---

## Description of categorial data

```{r}
df <- diamonds ## diamonds is a built-in data set
dim(df)
head(df)
```

---

## Example: explore data

How many distinct values are there in the variable `cut`?

```{r}
DiaCut <- df$cut
unique(DiaCut)
```

What is the frequency of each value?

```{r}
table(DiaCut)
```

---

## Bar graph

One way to visualize categorical data is to use a bar graph

```{r, out.width = "50%"}
g <- ggplot(data = df, aes(x = cut)) + 
  geom_bar() 
print(g)
```

---

## Exercise

- How many distinct values are there in the variable `color`?
- What is the frequency of each value in `color`?
- Draw a bar graph showing the frequency

--

```{r}
unique(df$color)
```

--

```{r}
table(df$color)
```

---

## Exercise, continued

```{r, out.width = "50%"}
ggplot(df, aes(color)) + ## can omit 'data = ' and 'x = '
  geom_bar()
```

---

## Two-way table

Frequency of color for each cut

```{r}
table(df$cut, df$color)
```

---

## Graphs using facets

```{r, out.width = "50%"}
ggplot(df, aes(color)) + ## can omit 'data = ' and 'x = '
  geom_bar() +
  facet_wrap(~cut) #<<
```

---

## Colored bar graphs

```{r, out.width = "75%", fig.asp = 0.7}
ggplot(df, aes(color, fill = clarity)) + #<<
  geom_bar() +
  facet_wrap(~cut) 
```

---

## Description of numerical data

What is the distribution of `carat` like?

```{r, out.width = "50%"}
ggplot(df, aes(carat)) +
  geom_histogram()
```

---

## Location and spread of numerical data

- Measure of location: sample mean and median
- Measure of spread: sample variance and standard deviation

```{r, out.width = "50%", echo = F}
ggplot(df, aes(carat)) +
  geom_histogram() +
  geom_vline(xintercept = mean(df$carat), lty = "dashed", color = "red")
```

---

## Example: find the sample mean

The sample mean is given by sum of samples divided by the number of samples:
$$\bar{x} = \frac{x_1+x_2+\cdots+x_n}{n}$$

```{r}
d <- read.table(file = "heights.txt", header = TRUE, sep = " ")
mom <- d$Mheight
s <- sum(mom); n <- length(mom)
mom_height_mean <- s/n
print(mom_height_mean)
```

R has a built in function to compute the mean:

```{r}
mean(mom) # mean() gives the mean of a vector
```

---

## Sample median

The median is the value separating the higher half from the lower half of numerical data. R has a built in function to compute the median. 

```{r}
median(mom)
```

In general, one can compute quantiles (cut points dividing range of numerical data).

```{r}
quantile(mom)
```

The median is the same as the 50% quantile. 

---

## Example

**Exercise**: Find the sample mean and median of `carat`.

--

```{r}
carat <- df$carat
mean(carat); median(carat)
```

--

**Exercise**: Find the 90% quantile `carat`.

--

```{r}
quantile(carat)
```

--

```{r}
quantile(carat, probs = 0.9)
```

---

## To be continued with spread

---

## Sample variance

The sample variance measures spread of given data:
$$s^2 =\frac{(x_1-\bar{x})^2+(x_2-\bar{x})^2+\cdots+(x_n-\bar{x})^2}{n-1}.$$
Note that the denominator is $n-1$, not $n$.

R has a built in function to compute the sample variance:

```{r}
var(mom) # var() gives the sample variance of a vector
```

One could also compute the sample variance using the definition:

```{r}
v1 <- mom-mean(mom); v2 <- v1^2
sum(v2)/(length(mom)-1)
```

---

## Sample standard deviation

The sample standard deviation also measures spread of given data -- it is simply the square root of the sample variance:
$$s = \sqrt{s^2} = \sqrt{\frac{(x_1-\bar{x})^2+(x_2-\bar{x})^2+\cdots+(x_n-\bar{x})^2}{n-1}}.$$

R has a built in function to compute the sample standard deviation:

```{r}
sd(mom) # sd() gives the sample standard deviation of a vector
```

---

## Normal distribution

- A continuous random variable $X$ is said to follow a _normal distribution_ $N(\mu, \sigma^2)$ if the probability $P(a\leq X \leq b)$ that $X$ is between $a$ and $b$ is given by 
$$P(a\leq X \leq b) = \int_a^b \phi_{\mu,\sigma}(x)\,dx,$$
where $$\phi_{\mu,\sigma}(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}.$$

- $\phi_{\mu,\sigma}(x)$ is a bell-shaped function called the probability distribution function (pdf) of $X$. $\mu$ is called the _mean_ and $\sigma$ is called the _standard deviation_.

- In particular, if $\mu = 0$ and $\sigma = 1$, $X$ is said to follow the _standard_ normal distribution.

---

## Normal pdf

```{r, echo = FALSE, fig.width = 5, fig.height = 2.5}
g <- ggplot(data = data.frame(x = 0), mapping = aes(x = x))
fun.1 <- function(x) dnorm(x, mean = 3, sd = 2)
fun.2 <- function(x) dnorm(x, mean = 0, sd = 1)

g1 <- g + 
  theme_bw() + 
  theme_classic() +
  stat_function(fun = fun.1) + xlim(-3, 9) + ylim(0, 0.4) +
  theme(aspect.ratio = 1) +
  geom_segment(x = 3, y = 0, xend = 3, yend = 0.2, lty = "dashed", color = "red") +
  ggtitle(bquote('N(3,'~2^2~')'))

g2 <- g + 
  theme_bw() + 
  theme_classic() +
  stat_function(fun = fun.2) + xlim(-2.5, 2.5) + ylim(0, 0.4) +
  theme(aspect.ratio = 1) +
  geom_segment(x = 0, y = 0, xend = 0, yend = 0.4, lty = "dashed", color = "red") +
  ggtitle(bquote('N(0,'~1^2~')'))

grid.arrange(g1, g2, ncol = 2)
```

_mean_ determines the center of the bell shape, while _standard deviation_ measures the spread.



