<!DOCTYPE html>
<html>
  <head>
    <title>Lecture 7</title>
    <meta charset="utf-8">
    <meta name="author" content="Jung-Jin Lee" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="Drexel.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Lecture 7
### Jung-Jin Lee
### Feb 26, 2019

---

 


## _t_-test: review

- One-sample `\(t\)`-test

  - Given sample, test `\(H_0: \mu = \mu_0\)`.

- Two-sample `\(t\)`-test:

  - With equal variance assumption
  
  - Without equal variance assumption (Welch's test)
  
  - Test `\(H_0\)`: two populations have the same mean. 
  
- Paired `\(t\)`-test

  - Need paired samples
  
  - Test `\(H_0\)`: two populations have the same mean. 

- In all cases, use `t.test()`

---

## _F_-test

- Comparison of two variances (Levene's test)

- Comparison of two or more means (one-way ANOVA)

---

## _F_-distribution

&lt;img src="Drexel_2019_Lecture_7_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## Levene's test

**Example**: A biologist is interested in comparing the lengths of female and male green lynx spiders. Assume that the length of male spiders follows `\(N(\mu_m, \sigma_m^2)\)` and the length female spiders follows `\(N(\mu_f, \sigma_f^2)\)`. 


```r
male = c(5.20, 4.70, 5.75, 7.50, 6.45, 6.55, 4.70, 4.80, 5.95, 
         5.20, 6.35, 6.95, 5.70, 6.20, 5.40, 6.20, 5.85, 6.80, 
         5.65, 5.50, 5.65, 5.85, 5.75, 6.35, 5.75, 5.95, 5.90, 
         7.00, 6.10, 5.80)
female = c(8.25, 9.95, 5.90, 7.05, 8.45, 7.55, 9.80, 10.80, 6.60, 
           7.55, 8.10, 9.10, 6.10, 9.30, 8.75, 7.00, 7.80, 8.00, 
           9.00, 6.30, 8.35, 8.70, 8.00, 7.50, 9.50)
c(length(male), length(female))
```

```
## [1] 30 25
```

```r
c(mean(male), mean(female))
```

```
## [1] 5.916667 8.136000
```

---

## Levene's test, continued


```r
# ggplot needs a dataframe
male_df &lt;- data.frame(sex = "male", length = male)
female_df &lt;- data.frame(sex = "female", length = female)
*spider &lt;- rbind(male_df, female_df)
```

&lt;img src="Drexel_2019_Lecture_7_files/figure-html/unnamed-chunk-5-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---

## Levene's test, continued

What can we say about variances? 

.pull-left[

```r
v_df &lt;- spider %&gt;%
* group_by(sex) %&gt;%
* summarize(va = var(length))
v_df
```

```
## # A tibble: 2 x 2
##   sex       va
##   &lt;fct&gt;  &lt;dbl&gt;
## 1 male   0.440
## 2 female 1.56
```

```r
ggplot(v_df, aes(sex, va)) +
* geom_col()
```
]

.pull-right[
&lt;img src="Drexel_2019_Lecture_7_files/figure-html/unnamed-chunk-8-1.png" style="display: block; margin: auto;" /&gt;
]

Can we say that the population variances are the same between male and female spiders? (i.e., `\(\sigma_m^2 = \sigma_f^2\)`?)

---

## Levene's test, continued

Suppose that `\(X_1,X_2,\ldots,X_n\)` (respectively, `\(Y_1,Y_2,\ldots,Y_m\)`) are taken from a population that follows `\(N(\mu_X,\sigma_X^2)\)` (respectively, `\(N(\mu_Y,\sigma_Y^2)\)`). Let 
`$$\bar{X}=\frac{X_1+X_2+\cdots+X_n}{n}, \quad \bar{Y}=\frac{Y_1+Y_2+\cdots+Y_m}{m},$$` 
and
`$$S_X^2=\frac{1}{n-1}\sum_{i=1}^n(X_i-\bar{X})^2, \quad S_Y^2=\frac{1}{m-1}\sum_{j=1}^m(Y_j-\bar{Y})^2.$$` 
Then
`$$\frac{S_X^2/\sigma_X^2}{S_Y^2/\sigma_Y^2}$$` follows an `\(F\)`-distribution with `\(df1=n-1\)` and `\(df2=m-1\)` degrees of freedom.

---

## Levene's test, continued

Going back to `spider` data, under the hypothesis `\(H_0: \sigma_m^2 = \sigma_f^2\)`, the fraction
`$$\frac{S_m^2/\sigma_m^2}{S_f^2/\sigma_f^2} = \frac{S_m^2}{S_f^2}$$` should follow an `\(F\)`-distribution with `$$df1=30-1=29 \quad \text{and}\quad df2=25-1=24$$` degrees of freedom.


```r
n &lt;- length(male); m &lt;- length(female)
var_m &lt;- var(male); var_f &lt;- var(female)
f &lt;- var_m/var_f
print(f)
```

```
## [1] 0.2816196
```

How likely or unlikely is this?

---

## Levene's test, continued

Under the null hypothesis `\(H_0: \sigma_m^2 = \sigma_f^2\)`, one would expect that `f` is close to 1. 

&lt;img src="Drexel_2019_Lecture_7_files/figure-html/unnamed-chunk-10-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## Levene's test, continued

The probability of an event that is as extreme as or more extreme than the current observation (red area) seems to be small.

&lt;img src="Drexel_2019_Lecture_7_files/figure-html/unnamed-chunk-11-1.png" width="90%" style="display: block; margin: auto;" /&gt;

---

## Levene's test, continued


```r
lower_red = pf(f, df1 = n-1, df2 = m-1)
pval = 2*lower_red
print(pval)
```

```
## [1] 0.001424841
```

--

`\(p\)`-value can be easily obtained by `var.test()`:


```r
var.test(male, female)
```

```
## 
## 	F test to compare two variances
## 
## data:  male and female
## F = 0.28162, num df = 29, denom df = 24, p-value = 0.001425
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.1270020 0.6066102
## sample estimates:
## ratio of variances 
##          0.2816196
```

---

## Aside: one-sample variance test

One-sample variance test is based on `\(\chi^2\)`-test and can be done using `VarTest()` in `DescTools` pacakge. 


```r
#install.packages("DescTools")
library(DescTools)
# To test if population variance equals 0.5
VarTest(male, sigma.squared = 0.5) 
```

```
## 
## 	One Sample Chi-Square test on variance
## 
## data:  male
## X-squared = 25.513, df = 29, p-value = 0.6973
## alternative hypothesis: true variance is not equal to 0.5
## 95 percent confidence interval:
##  0.2790033 0.7949529
## sample estimates:
## variance of x 
##     0.4398851
```

---

## One-way ANOVA (ANalysis Of VAriance)

**Example**: Dogs were fed a dry diet coated with different agents that were believed to affect the build-up of calculus on the teeth. Calculus accumulation was measured by an index that combined estimates of both the proportion of the teeth covered by the deposit and the thickness of the deposit. 26 dogs were randomly allocated to three treatments: `control`, soluble pyrophosphate (`p2o7`), and sodium hexametaphosphate (`hmp`). The data are presented in the following:


```r
control &lt;- c(0.49, 1.05, 0.79, 1.35, 0.55, 1.36, 1.55, 1.66, 1.00)
p2o7 &lt;- c(0.34, 0.76, 0.45, 0.69, 0.87, 0.94, 0.22, 1.07, 1.38)
hmp &lt;- c(0.34, 0.05, 0.53, 0.19, 0.28, 0.45, 0.71, 0.95)
```

Can we say that all the three means are equal?

---

## Box plots


```r
ctrl_df &lt;- data.frame(diet = "Control", index = control)
pyro_df &lt;- data.frame(diet = "Pyrophosphate", index = p2o7)
sod_hexa_df &lt;- data.frame(diet = "Hexametaphosphate", index = hmp)
dogs &lt;- rbind(ctrl_df, pyro_df, sod_hexa_df)
table(dogs$diet)
```

```
## 
##           Control     Pyrophosphate Hexametaphosphate 
##                 9                 9                 8
```

```r
mean_df &lt;- dogs %&gt;%
  group_by(diet) %&gt;%
  summarize(mean_index = mean(index))
mean_df
```

```
## # A tibble: 3 x 2
##   diet              mean_index
##   &lt;fct&gt;                  &lt;dbl&gt;
## 1 Control                1.09 
## 2 Pyrophosphate          0.747
## 3 Hexametaphosphate      0.438
```
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
